<app-navbar></app-navbar>
<div class="container" *ngIf="!load">
  <hr>
  <hr>
  <div class="row" *ngIf="servicio.status == 1">
    <div class="col">
      <div class="card w-100">
        <div class="card-body">
          <h5 class="card-title">Actualizar servicio programado</h5>
          <hr>

          <form [formGroup]="servicioProgramado" (ngSubmit)="save()">
            <div class="row">
              <div class="col">
                <h6 class="card-subtitle">Asignación de Contrato, equipo EMG y Técnico</h6>
              </div>
            </div>
            <div class="row">
              <div class="col">
                <div class="form-group">
                  <label for="emg"><span class="text-danger">*</span>Equipo EMG</label>
                  <select class="form-control form-control-sm" id="emg" formControlName="emg" (change)="contratosByClient()">
                    <option *ngFor="let emg of emgs" value="{{emg._id}}">{{emg.info.name}}</option>
                  </select>
                  <div *ngIf="servicioProgramado.get('emg').errors&&servicioProgramado.get('emg').dirty">
                    <p *ngIf="servicioProgramado.get('emg').hasError('required')" class="text-danger">El equipo es requerido</p>
                  </div>
                </div>
              </div>
              <div class="col">
                <div class="form-group">
                  <label for="tecnico"><span class="text-danger">*</span>Técnico a asignar</label>
                  <select class="form-control form-control-sm" id="tecnico" formControlName="tecnico">
                    <option *ngFor="let tecnico of tecnicos" value="{{tecnico._id}}">{{tecnico.info.name}}</option>
                  </select>
                  <div *ngIf="servicioProgramado.get('tecnico').errors&&servicioProgramado.get('tecnico').dirty">
                    <p *ngIf="servicioProgramado.get('tecnico').hasError('required')" class="text-danger">El tecnico es requerido</p>
                  </div>
                </div>
              </div>
              <div class="col">
                <div class="form-group">
                  <label for="agreement"><span class="text-danger">*</span>Contrato</label>
                  <select class="form-control form-control-sm" id="agreement" formControlName="agreement" (change)="selectContrato()">
                    <option *ngFor="let contrato of contratos" value="{{contrato._id}}">{{contrato.name}}</option>
                  </select>
                  <div *ngIf="servicioProgramado.get('agreement').errors&&servicioProgramado.get('agreement').dirty">
                    <p *ngIf="servicioProgramado.get('agreement').hasError('required')" class="text-danger">El equipo es requerido</p>
                  </div>
                </div>
              </div>
            </div>
            <hr>
            <div class="row">
              <div class="col">
                <h6 class="card-subtitle">Información del servicio requerido</h6>
              </div>
            </div>
            <div class="row">
              <div class="col">
                <div class="form-group">
                  <label for="type"><span class="text-danger">*</span>Tipo de servicio</label>
                  <select class="form-control form-control-sm" id="type" formControlName="type">
                    <option *ngFor="let tipo of tipos" value="{{tipo.name}}">{{tipo.name}}</option>
                  </select>
                  <div *ngIf="servicioProgramado.get('type').errors&&servicioProgramado.get('type').dirty">
                    <p *ngIf="servicioProgramado.get('type').hasError('required')" class="text-danger">El tipo es requerido</p>
                  </div>
                </div>
              </div>
              <div class="col">
                <div class="form-group">
                  <label for="date"><span class="text-danger">*</span>Fecha y hora</label>
                  <input type="datetime-local" class="form-control form-control-sm" id="date" formControlName="date" min="{{minDate}}" max="{{maxDate}}">
                </div>
                <div *ngIf="servicioProgramado.get('date').errors&&servicioProgramado.get('date').dirty">
                  <p *ngIf="servicioProgramado.get('date').hasError('required')" class="text-danger">La fecha es requerido</p>
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col">
                <div class="form-group">
                  <label for="Descripción"><span class="text-danger">*</span>Descripción a detalle del servico</label>
                  <input type="text" class="form-control form-control-sm" id="Descripción" formControlName="desc">
                  <div *ngIf="servicioProgramado.get('desc').errors&&servicioProgramado.get('desc').dirty">
                    <p *ngIf="servicioProgramado.get('desc').hasError('required')" class="text-danger">La descripción es requerida</p>
                  </div>
                </div>
              </div>
            </div>
            <br>
            <div class="row">
                <div class="col-4">
                    <div class="pad1 w-100">
                        <button type="button" class="btn btn-info w-100" (click)="regresar()">Regresar</button>
                    </div>
                </div>
                <div class="col-4">
                    <div class="pad1 w-100">
                        <button type="submit" class="btn btn-primary w-100" [disabled]="servicioProgramado.invalid">Programar</button>                    
                    </div>
                </div>
            </div>
          </form>

        </div>
      </div>
    </div>
  </div>
  <div class="row" *ngIf="servicio.status == 3">
    <div class="col">
      <div class="card">

      </div>
      realizado
    </div>
  </div>
  <hr>
  <hr>
</div>

<div class="container" *ngIf="load">
  <div class="row">
    <p class="lead mx-auto">
      CARGANDO
    </p>
  </div>
  <div class="row">
    <div class="col">
      <mat-spinner class="mx-auto"></mat-spinner>
    </div>
  </div>
</div>

<app-footer></app-footer>